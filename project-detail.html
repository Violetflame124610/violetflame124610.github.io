<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project - Violetflame124610</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23grad)'/%3E%3Ctext x='50' y='70' font-family='Arial, sans-serif' font-size='60' font-weight='bold' fill='white' text-anchor='middle'%3EVF%3C/text%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Manrope:wght@300;400;600;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        #project-detail {
            max-width: 860px;
            margin: 0 auto;
            padding: 7rem 5% 5rem;
            min-height: 100vh;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 2.5rem;
            transition: gap 0.25s, color 0.25s;
        }
        .back-btn:hover { gap: 1rem; color: var(--secondary); }

        /* Title */
        .repo-title {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 900;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.6rem;
            animation: floatIn 0.5s ease-out both;
        }
        .repo-desc {
            color: var(--text-muted);
            font-size: 1.05rem;
            margin-bottom: 2.5rem;
            animation: floatIn 0.5s ease-out 0.1s both;
        }

        /* Info pills row */
        .info-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 2.5rem;
            animation: floatIn 0.5s ease-out 0.15s both;
        }

        .info-pill {
            display: flex;
            align-items: center;
            gap: 0.55rem;
            background: var(--surface-light);
            border: 1px solid rgba(127,90,240,0.2);
            border-radius: 30px;
            padding: 0.5rem 1.1rem;
            font-size: 0.88rem;
            color: var(--text-muted);
        }
        .info-pill svg { width: 14px; height: 14px; fill: var(--accent); flex-shrink: 0; }
        .info-pill strong { color: var(--text); }

        /* Languages */
        .section-block {
            background: var(--surface-light);
            border: 1px solid rgba(127,90,240,0.2);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 2rem;
            animation: floatIn 0.5s ease-out 0.2s both;
        }

        .section-block-header {
            display: flex;
            align-items: center;
            gap: 0.7rem;
            padding: 0.9rem 1.4rem;
            background: rgba(127,90,240,0.1);
            border-bottom: 1px solid rgba(127,90,240,0.15);
            font-weight: 700;
            font-size: 0.9rem;
            color: var(--text);
            letter-spacing: 0.3px;
        }
        .section-block-header svg { width: 16px; height: 16px; fill: var(--accent); }

        .section-block-body { padding: 1.4rem; }

        /* Language bar */
        .lang-bar {
            height: 10px;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            margin-bottom: 1rem;
        }
        .lang-segment { height: 100%; transition: flex 0.4s; }

        .lang-legend { display: flex; flex-wrap: wrap; gap: 0.6rem 1.4rem; }
        .lang-item {
            display: flex;
            align-items: center;
            gap: 0.45rem;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        .lang-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
        .lang-pct { opacity: 0.55; font-size: 0.8rem; }

        /* README */
        .readme-block { animation: floatIn 0.5s ease-out 0.25s both; }

        .readme-body {
            padding: 1.8rem;
            color: var(--text-muted);
            font-size: 1rem;
            line-height: 1.85;
        }
        .readme-body h1, .readme-body h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.55rem;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 1.5rem 0 0.6rem;
        }
        .readme-body h3 { color: var(--text); font-size: 1.15rem; margin: 1.2rem 0 0.5rem; }
        .readme-body p  { margin-bottom: 1rem; }
        .readme-body ul, .readme-body ol { margin: 0.6rem 0 1rem 1.5rem; }
        .readme-body li { margin-bottom: 0.35rem; }
        .readme-body a  { color: var(--accent); text-decoration: none; }
        .readme-body a:hover { color: var(--secondary); text-decoration: underline; }
        .readme-body img { max-width: 100%; border-radius: 8px; margin: 0.5rem 0; }
        .readme-body hr  { border: none; border-top: 1px solid rgba(127,90,240,0.2); margin: 1.5rem 0; }
        .readme-body blockquote {
            border-left: 3px solid var(--accent);
            padding-left: 1rem; margin: 1rem 0;
            color: var(--text-muted); font-style: italic;
        }
        .readme-body code {
            background: rgba(127,90,240,0.15);
            border: 1px solid rgba(127,90,240,0.2);
            border-radius: 4px;
            padding: 0.15rem 0.4rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.87em;
            color: #c9b1ff;
        }
        .readme-body pre {
            background: rgba(0,0,0,0.35);
            border: 1px solid rgba(127,90,240,0.2);
            border-radius: 10px;
            padding: 1.2rem; overflow-x: auto; margin: 1rem 0;
        }
        .readme-body pre code { background: none; border: none; padding: 0; }
        .readme-body table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem; }
        .readme-body th, .readme-body td { padding: 0.5rem 0.9rem; border: 1px solid rgba(127,90,240,0.2); }
        .readme-body th { background: rgba(127,90,240,0.1); color: var(--text); font-weight: 700; }

        .no-readme { padding: 1.5rem; text-align: center; color: var(--text-muted); font-size: 0.95rem; }

        /* GitHub button at bottom */
        .bottom-actions {
            margin-top: 2rem;
            animation: floatIn 0.5s ease-out 0.3s both;
        }

        /* Loading state */
        .page-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
            gap: 1rem;
            color: var(--text-muted);
        }

        @media (max-width: 600px) {
            .repo-title { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">VF</div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="projects.html" class="active">Projects</a></li>
            <li><a href="about.html">About</a></li>
        </ul>
    </nav>

    <div id="project-detail">
        <a href="projects.html" class="back-btn">← Back to Projects</a>
        <div id="pageContent">
            <div class="page-loading">
                <div class="spinner"></div>
                Loading project…
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        const GITHUB_USERNAME = 'Violetflame124610';
        const GITHUB_API      = 'https://api.github.com';
        const params          = new URLSearchParams(window.location.search);
        const repoName        = params.get('repo');

        if (!repoName) window.location.href = 'projects.html';
        document.title = `${repoName} - Violetflame124610`;

        const LANG_COLORS = {
            'JavaScript':'#f1e05a','Python':'#3572A5','Java':'#b07219',
            'HTML':'#e34c26','CSS':'#563d7c','TypeScript':'#2b7489',
            'C++':'#f34b7d','C':'#555555','Go':'#00ADD8','Rust':'#dea584',
            'Ruby':'#701516','PHP':'#4F5D95','Swift':'#ffac45','Kotlin':'#F18E33',
            'Dart':'#00B4AB','C#':'#178600','Shell':'#89e051','Vue':'#41b883',
        };

        async function go() {
            const container = document.getElementById('pageContent');
            try {
                // Fetch repo info, languages + readme all at once (3 calls only)
                const [repoRes, langRes, readmeRes] = await Promise.all([
                    fetch(`${GITHUB_API}/repos/${GITHUB_USERNAME}/${repoName}`),
                    fetch(`${GITHUB_API}/repos/${GITHUB_USERNAME}/${repoName}/languages`),
                    fetch(`${GITHUB_API}/repos/${GITHUB_USERNAME}/${repoName}/readme`)
                ]);

                const repo     = repoRes.ok ? await repoRes.json() : null;
                const langs    = langRes.ok  ? await langRes.json()  : {};
                const readme   = readmeRes.ok ? await readmeRes.json() : null;

                if (!repo) throw new Error('Repo not found');

                container.innerHTML = `
                    <h1 class="repo-title">${repo.name}</h1>
                    <p class="repo-desc">${repo.description || 'No description provided'}</p>

                    <div class="info-row">
                        ${repo.license ? `
                        <div class="info-pill">
                            ${licenseIcon()}
                            <span><strong>License:</strong> ${repo.license.spdx_id || repo.license.name}</span>
                        </div>` : ''}
                        <div class="info-pill">
                            ${starIcon()}
                            <span><strong>${repo.stargazers_count}</strong> Stars</span>
                        </div>
                        <div class="info-pill">
                            ${forkIcon()}
                            <span><strong>${repo.forks_count}</strong> Forks</span>
                        </div>
                        <div class="info-pill">
                            ${calIcon()}
                            <span>Updated ${formatDate(new Date(repo.updated_at))}</span>
                        </div>
                    </div>

                    ${buildLangsHTML(langs)}
                    ${buildReadmeHTML(readme)}

                    <div class="bottom-actions">
                        <a href="${repo.html_url}" target="_blank" class="project-link">
                            View on GitHub →
                        </a>
                    </div>
                `;

            } catch (err) {
                container.innerHTML = `
                    <p style="color:var(--text-muted);margin-top:2rem;">
                        Could not load this project. 
                        <a href="https://github.com/${GITHUB_USERNAME}/${repoName}" 
                           target="_blank" class="project-link" style="margin-left:0.5rem;">
                           View on GitHub →
                        </a>
                    </p>`;
            }
        }

        function buildLangsHTML(langs) {
            const total = Object.values(langs).reduce((a, b) => a + b, 0);
            if (total === 0) return '';

            const bar = Object.entries(langs).map(([lang, bytes]) => {
                const pct   = ((bytes / total) * 100).toFixed(1);
                const color = LANG_COLORS[lang] || '#858585';
                return `<div class="lang-segment" style="flex:${pct};background:${color}" title="${lang} ${pct}%"></div>`;
            }).join('');

            const legend = Object.entries(langs).map(([lang, bytes]) => {
                const pct   = ((bytes / total) * 100).toFixed(1);
                const color = LANG_COLORS[lang] || '#858585';
                return `<div class="lang-item">
                            <span class="lang-dot" style="background:${color}"></span>
                            <span>${lang}</span>
                            <span class="lang-pct">${pct}%</span>
                        </div>`;
            }).join('');

            return `
                <div class="section-block">
                    <div class="section-block-header">${codeIcon()} Languages</div>
                    <div class="section-block-body">
                        <div class="lang-bar">${bar}</div>
                        <div class="lang-legend">${legend}</div>
                    </div>
                </div>`;
        }

        function buildReadmeHTML(readmeData) {
            const body = readmeData?.content
                ? `<div class="readme-body">${mdToHTML(atob(readmeData.content.replace(/\n/g, '')))}</div>`
                : `<div class="no-readme">No README.md found for this repository.</div>`;

            return `
                <div class="section-block readme-block">
                    <div class="section-block-header">${docIcon()} README.md</div>
                    ${body}
                </div>`;
        }

        /* ── Markdown → HTML ── */
        function mdToHTML(md) {
            let h = md;
            h = h.replace(/```(\w*)\n?([\s\S]*?)```/g, (_, l, c) =>
                `<pre><code>${esc(c.trim())}</code></pre>`);
            h = h.replace(/`([^`]+)`/g, (_, c) => `<code>${esc(c)}</code>`);
            h = h.replace(/^#{6} (.+)$/gm,'<h6>$1</h6>');
            h = h.replace(/^#{5} (.+)$/gm,'<h5>$1</h5>');
            h = h.replace(/^#{4} (.+)$/gm,'<h4>$1</h4>');
            h = h.replace(/^#{3} (.+)$/gm,'<h3>$1</h3>');
            h = h.replace(/^#{2} (.+)$/gm,'<h2>$1</h2>');
            h = h.replace(/^# (.+)$/gm,  '<h1>$1</h1>');
            h = h.replace(/^---+$/gm,'<hr>');
            h = h.replace(/^> (.+)$/gm,'<blockquote>$1</blockquote>');
            h = h.replace(/\*\*\*(.+?)\*\*\*/g,'<strong><em>$1</em></strong>');
            h = h.replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>');
            h = h.replace(/\*(.+?)\*/g,'<em>$1</em>');
            h = h.replace(/~~(.+?)~~/g,'<del>$1</del>');
            h = h.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,'<img src="$2" alt="$1" loading="lazy">');
            h = h.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>');
            h = h.replace(/(^[*-] .+\n?)+/gm, m => {
                const items = m.trim().split('\n').map(l=>`<li>${l.replace(/^[*-] /,'')}</li>`).join('');
                return `<ul>${items}</ul>`;
            });
            h = h.replace(/(^\d+\. .+\n?)+/gm, m => {
                const items = m.trim().split('\n').map(l=>`<li>${l.replace(/^\d+\. /,'')}</li>`).join('');
                return `<ol>${items}</ol>`;
            });
            h = h.split('\n\n').map(b => {
                b = b.trim();
                if (!b) return '';
                if (/^<(h[1-6]|ul|ol|pre|blockquote|hr|img|table)/.test(b)) return b;
                return `<p>${b.replace(/\n/g,'<br>')}</p>`;
            }).join('\n');
            return h;
        }

        function esc(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

        /* ── Icons ── */
        function licenseIcon(){ return `<svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/></svg>`; }
        function starIcon()   { return `<svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>`; }
        function forkIcon()   { return `<svg viewBox="0 0 24 24"><path d="M6 3a3 3 0 1 0 4 2.83V9.17A3 3 0 1 0 12 12a3 3 0 0 0 2-2.83V5.83A3 3 0 1 0 18 3a3 3 0 0 0-3 2.83V9.17a3 3 0 0 1-3 0V5.83A3 3 0 0 0 6 3z"/></svg>`; }
        function calIcon()    { return `<svg viewBox="0 0 24 24"><path d="M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"/></svg>`; }
        function codeIcon()   { return `<svg viewBox="0 0 24 24"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/></svg>`; }
        function docIcon()    { return `<svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm-1 1.5L18.5 9H13V3.5zM6 20V4h5v7h7v9H6z"/></svg>`; }

        go();
    </script>
</body>
</html>
